<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Prayer Times</title>
    <style>
      body {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        caret-color: transparent; /* Hide the blinking cursor */
        flex-direction: column;
        background: url("background.jpg") no-repeat center center fixed;
        background-size: cover;
        color: #000; /* Default text color set to black */
        transition: background-color 0.3s, color 0.3s;
      }
      table {
        width: 100%;
        max-width: 600px;
        border-collapse: collapse;
        margin: 0 auto;
        background-color: #fff; /* Background color set to white */
      }
      th,
      td {
        border: 1px solid #000; /* Border color set to black */
        padding: 10px;
        text-align: left;
      }
      th {
        background-color: rgba(
          0,
          0,
          0,
          0.1
        ); /* Light gray background for table headers */
      }
      td {
        letter-spacing: 2px;
      }
      .highlight {
        background-color: yellow; /* Highlight color set to yellow */
      }
      .dark-mode {
        background-color: #121212;
        color: #ffffff;
      }
      .dark-mode table {
        background-color: #000; /* Background color set to black in dark mode */
      }
      .dark-mode th {
        background-color: #333333;
      }
      .dark-mode td {
        border: 1px solid #ffffff;
      }
      .dark-mode h1,
      .dark-mode #clock {
        color: #ffffff;
      }
      h1,
      #clock {
        color: #000; /* Default color set to black */
      }
      #toggle-dark-mode {
        background-color: #4caf50; /* Green */
        border: none;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 20px 2px;
        cursor: pointer;
        border-radius: 12px;
        transition: background-color 0.3s, transform 0.3s, box-shadow 0.3s;
        animation: creativePulse 2s infinite;
      }
      #toggle-dark-mode:hover {
        background-color: #45a049;
        transform: scale(1.1);
      }
      @keyframes creativePulse {
        0% {
          transform: scale(1);
          box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        }
        50% {
          transform: scale(1.1);
          box-shadow: 0 0 20px rgba(0, 0, 0, 0.4);
        }
        100% {
          transform: scale(1);
          box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        }
      }
      #clock {
        font-size: 2em;
        margin-bottom: 20px;
      }
      #weather {
        margin-top: 20px;
        font-size: 1.2em;
      }
    </style>
  </head>
  <body>
    <div id="clock"></div>
    <h1>Prayer Times</h1>
    <button id="toggle-dark-mode">Toggle Dark Mode</button>
    <table id="prayer-times">
      <thead>
        <tr>
          <th>Prayer</th>
          <th>Time</th>
        </tr>
      </thead>
      <tbody>
        <!-- Prayer times will be inserted here -->
      </tbody>
    </table>
    <div id="weather"></div>

    <script>
      function updateClock() {
        const now = new Date();
        const hours = String(now.getHours()).padStart(2, "0");
        const minutes = String(now.getMinutes()).padStart(2, "0");
        const seconds = String(now.getSeconds()).padStart(2, "0");
        document.getElementById(
          "clock"
        ).textContent = `${hours}:${minutes}:${seconds}`;
      }
      setInterval(updateClock, 1000);
      updateClock();

      const apiKey = "YOUR_API_KEY"; // If required
      const city = "London";
      const country = "Canada";
      const prayerUrl = `https://api.aladhan.com/v1/timingsByCity?city=${city}&country=${country}&method=2`;
      const weatherUrl = `https://api.openweathermap.org/data/2.5/weather?q=${city},${country}&appid=YOUR_WEATHER_API_KEY&units=metric`;

      document
        .getElementById("toggle-dark-mode")
        .addEventListener("click", () => {
          document.body.classList.toggle("dark-mode");
        });

      fetch(prayerUrl)
        .then((response) => response.json())
        .then((data) => {
          const timings = data.data.timings;
          const prayerTimesTable = document
            .getElementById("prayer-times")
            .getElementsByTagName("tbody")[0];

          const prayersToShow = [
            "Fajr",
            "Sunrise",
            "Dhuhr",
            "Asr",
            "Maghrib",
            "Isha",
          ];
          const now = new Date();
          const currentTime = now.getHours() * 60 + now.getMinutes();

          console.log("Current Time:", currentTime);

          let nextPrayer = null;
          let nextPrayerTime = Infinity;

          prayersToShow.forEach((prayer) => {
            const [hours, minutes] = timings[prayer].split(":").map(Number);
            const prayerTime = hours * 60 + minutes;

            console.log(
              `Prayer: ${prayer}, Time: ${timings[prayer]}, Prayer Time in Minutes: ${prayerTime}`
            );

            const row = document.createElement("tr");
            const prayerCell = document.createElement("td");
            const timeCell = document.createElement("td");

            prayerCell.textContent = prayer;
            timeCell.textContent = timings[prayer];

            row.appendChild(prayerCell);
            row.appendChild(timeCell);
            prayerTimesTable.appendChild(row);

            if (prayerTime > currentTime && prayerTime < nextPrayerTime) {
              nextPrayerTime = prayerTime;
              nextPrayer = row;
            }
          });

          if (nextPrayer) {
            nextPrayer.classList.add("highlight");
            console.log("Next Prayer Highlighted:", nextPrayer);
          }
        })
        .catch((error) => console.error("Error fetching prayer times:", error));

      fetch(weatherUrl)
        .then((response) => response.json())
        .then((data) => {
          const weatherDiv = document.getElementById("weather");
          const temperature = data.main.temp;
          const description = data.weather[0].description;
          weatherDiv.textContent = `Current weather in ${city}: ${temperature}Â°C, ${description}`;
        })
        .catch((error) => console.error("Error fetching weather data:", error));
    </script>
  </body>
</html>
